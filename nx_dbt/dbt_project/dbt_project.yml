config-version: 2

name: nextail
version: "0.0.1"
require-dbt-version: ">=1.9.2"

profile: nx_internal_profile

model-paths: ["models"]
analysis-paths: ["analyses"]
test-paths: ["data-tests"]
seed-paths: ["seeds"]
macro-paths: ["macros"]
snapshot-paths: ["snapshots"]

target-path: "target"
clean-targets:
  - "target"
  - "dbt_packages"

vars:
  # variable environment is set to "development" or os.environ.get("ENVIRONMENT")
  "DBT_WAREHOUSE": "{{ env_var('DBT_WAREHOUSE') }}" # required to set the config in the dynamic tables; we need to set a dbt var because the config block cannot use env_var
  "full_refresh_start_date": "2025-01-01"
  # "dbt_date:time_zone": "America/Los_Angeles"
  "dbt_date:time_zone": "Etc/UTC"
  "tenant": "nextail"
  "all_tenants": [
    "ARISTOCRAZY",
    # "BASE",
    "BIMANI",
    "BZB",
    "CALLIOPE",
    "DCK",
    "DUB",
    "ECIBOLSOSMMEE",
    "ECICAMISERIACABALLEROMMEE",
    "ECIEASYWEARELLA",
    "ECIGAP",
    "ECIKIDS",
    "ECILLOYDSMEN",
    "ECIZAPATERIASENORAS",
    "ECRU",
    "ETHNICITY",
    "FLYINGTIGER",
    "FOOTGEAR",
    "FOREVERNEW",
    "GINATRICOT",
    "GSTARRETAIL",
    "GSTAR",
    "GUESSEMEA",
    "GUESSUS",
    "HACKETT",
    "JOTT",
    "JULES",
    "MAAG",
    "MERKAL",
    "METROBRANDS",
    "MFG",
    "MOUNTAINWAREHOUSE",
    "PEPE",
    "RIVERISLAND",
    "SCOTTA",
    "SILBON",
    "SFERABASICMAN",
    # "SISIFO",
    "SPORTSEMOTION",
    "SPORTSTREET",
    "SUAREZ",
    "TERRANOVA",
    "TVOE",
    "VALEXTRA",
    "VILET",
    "WHITESTUFF",
    "WOOLRICH"
  ]

flags:
  send_anonymous_usage_stats: false
  use_colors: true
  # partial_parse: <true | false>
  # printer_width: <integer>
  # write_json: <true | false>
  # warn_error: <true | false>
  # warn_error_options: <include: all | include: [<error-name>] | include: all, exclude: [<error-name>]>
  # log_format: <text | json | default>
  debug: false
  # version_check: <true | false>
  # fail_fast: <true | false>
  # use_experimental_parser: <true | false>
  # static_parser: <true | false>

models:
  +materialized: table
  +transient: true
  +persist_docs:
    relation: true
    # column: true
  +grants:
    select: ['BI_READER_{{ env_var("NX_ENVIRONMENT", "NX_ENVIRONMENT_NOT_SET") }}_RL']

  nextail:
    # must be NEXTAIL_INTERNALS_<ENVIRONMENT>_DB
    +database: NEXTAIL_INTERNALS_{{ env_var('NX_ENVIRONMENT', 'NX_ENVIRONMENT_NOT_SET') }}_DB
    costs:
      costs_staging:
        +schema: nx_costs_bronze

      costs_silver:
        +schema: nx_costs_silver

      costs_gold:
        +schema: nx_gold

      ## DEPRECATED FOLDERS
      DEPRECATED:
        +enabled: false
      
    internal:
      internal_staging:
        # +database: NEXTAIL_INTERNALS_SANDBOX_DB
        +schema: nx_internals_bronze

    sales_engineering:
      # +database: NEXTAIL_INTERNALS_SANDBOX_DB
      +schema: nx_sales_engineering_playground


# dispatch:
#   - macro_namespace: dbt
#     search_order:
#       - nx_internal_reporting
#       - dbt_snowflake_query_tags
#       - dbt
